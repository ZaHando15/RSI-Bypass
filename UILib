-- UILib.lua
-- Full UI Library with tabs, buttons, sliders, dropdowns, toggles, color pickers, labels, paragraphs, inputs, and keybinds

local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")

local UILibrary = {}

function UILibrary:MakeWindow(titleText)
    local player = Players.LocalPlayer
    local gui = Instance.new("ScreenGui")
    gui.Name = "ExecutorUI"
    gui.ResetOnSpawn = false
    gui.Parent = player:WaitForChild("PlayerGui")

    -- Main window
    local main = Instance.new("Frame")
    main.Size = UDim2.new(0,600,0,400)
    main.Position = UDim2.new(0.5,-300,0.5,-200)
    main.BackgroundColor3 = Color3.fromRGB(20,20,20)
    main.BorderSizePixel = 0
    main.ClipsDescendants = true
    main.Parent = gui
    Instance.new("UICorner", main).CornerRadius = UDim.new(0,10)

    -- Dragging
    local dragging, dragStart, startPos = false, nil, nil
    local function beginDrag(input)
        dragging = true
        dragStart = input.Position
        startPos = main.Position
    end
    local function endDrag() dragging = false end
    UIS.InputChanged:Connect(function(input)
        if dragging and input.UserInputType==Enum.UserInputType.MouseMovement then
            local delta = input.Position - dragStart
            main.Position = UDim2.new(
                startPos.X.Scale,
                startPos.X.Offset + delta.X,
                startPos.Y.Scale,
                startPos.Y.Offset + delta.Y
            )
        end
    end)

    -- Top bar
    local bar = Instance.new("Frame", main)
    bar.Size = UDim2.new(1,0,0,40)
    bar.BackgroundColor3 = Color3.fromRGB(30,30,30)
    bar.BorderSizePixel = 0
    Instance.new("UICorner", bar).CornerRadius = UDim.new(0,10)

    bar.InputBegan:Connect(function(input)
        if input.UserInputType==Enum.UserInputType.MouseButton1 then beginDrag(input) end
    end)
    bar.InputEnded:Connect(function(input)
        if input.UserInputType==Enum.UserInputType.MouseButton1 then endDrag() end
    end)

    local title = Instance.new("TextLabel", bar)
    title.Size = UDim2.new(1,-90,1,0)
    title.Position = UDim2.new(0,12,0,0)
    title.BackgroundTransparency = 1
    title.Font = Enum.Font.GothamBold
    title.Text = titleText or "Executor UI"
    title.TextColor3 = Color3.fromRGB(210,210,210)
    title.TextSize = 17
    title.TextXAlignment = Enum.TextXAlignment.Left

    -- Close + Minimize
    local close = Instance.new("TextButton", bar)
    close.Size = UDim2.new(0,35,0,26)
    close.Position = UDim2.new(1,-40,0.5,-13)
    close.BackgroundColor3 = Color3.fromRGB(50,20,20)
    close.Text = "X"
    close.Font = Enum.Font.GothamBold
    close.TextColor3 = Color3.fromRGB(255,90,90)
    close.TextSize = 16
    Instance.new("UICorner", close).CornerRadius = UDim.new(0,6)

    local min = Instance.new("TextButton", bar)
    min.Size = UDim2.new(0,35,0,26)
    min.Position = UDim2.new(1,-80,0.5,-13)
    min.BackgroundColor3 = Color3.fromRGB(40,40,40)
    min.Text = "â€“"
    min.Font = Enum.Font.GothamBold
    min.TextColor3 = Color3.fromRGB(200,200,200)
    min.TextSize = 24
    Instance.new("UICorner", min).CornerRadius = UDim.new(0,6)

    -- Bottom panel
    local bottom = Instance.new("Frame", main)
    bottom.Size = UDim2.new(1,-20,1,-60)
    bottom.Position = UDim2.new(0,10,0,50)
    bottom.BackgroundColor3 = Color3.fromRGB(25,25,25)
    bottom.BorderSizePixel = 0
    bottom.ClipsDescendants = true
    Instance.new("UICorner", bottom).CornerRadius = UDim.new(0,8)

    -- Left tab list
    local leftTab = Instance.new("Frame", bottom)
    leftTab.Size = UDim2.new(0,130,1,0)
    leftTab.BackgroundColor3 = Color3.fromRGB(30,30,30)
    leftTab.BorderSizePixel = 0
    leftTab.ClipsDescendants = true
    Instance.new("UICorner", leftTab).CornerRadius = UDim.new(0,8)

    local tabList = Instance.new("UIListLayout", leftTab)
    tabList.SortOrder = Enum.SortOrder.LayoutOrder
    tabList.Padding = UDim.new(0,4)

    -- Right content panel
    local rightPanel = Instance.new("Frame", bottom)
    rightPanel.Size = UDim2.new(1,-140,1,0)
    rightPanel.Position = UDim2.new(0,140,0,0)
    rightPanel.BackgroundColor3 = Color3.fromRGB(15,15,15)
    rightPanel.BorderSizePixel = 0
    Instance.new("UICorner", rightPanel).CornerRadius = UDim.new(0,8)

    -- Animations
    local minimized = false
    local fullSize = UDim2.new(0,600,0,400)
    local minSize = UDim2.new(0,600,0,40)

    min.MouseButton1Click:Connect(function()
        minimized = not minimized
        local target = minimized and minSize or fullSize
        TweenService:Create(main,TweenInfo.new(.25,Enum.EasingStyle.Sine),{Size=target}):Play()
        if minimized then
            TweenService:Create(bottom,TweenInfo.new(.2),{Size=UDim2.new(1,-20,0,0)}):Play()
        else
            TweenService:Create(bottom,TweenInfo.new(.2),{Size=UDim2.new(1,-20,1,-60)}):Play()
        end
    end)

    close.MouseButton1Click:Connect(function()
        TweenService:Create(main,TweenInfo.new(.25),{Size=minSize}):Play()
        TweenService:Create(bottom,TweenInfo.new(.25),{Size=UDim2.new(1,-20,0,0)}):Play()
        task.wait(.4)
        TweenService:Create(main,TweenInfo.new(.35),{Size=UDim2.new(0,0,0,40)}):Play()
        task.wait(.35)
        gui:Destroy()
    end)

    -- API
    local Window = {}

    function Window:MakeTab(name)
        local tabButton = Instance.new("TextButton", leftTab)
        tabButton.Size = UDim2.new(1,-10,0,28)
        tabButton.BackgroundColor3 = Color3.fromRGB(40,40,40)
        tabButton.Text = name
        tabButton.Font = Enum.Font.GothamBold
        tabButton.TextColor3 = Color3.fromRGB(220,220,220)
        tabButton.TextSize = 14
        Instance.new("UICorner", tabButton).CornerRadius = UDim.new(0,6)

        local tabContent = Instance.new("Frame", rightPanel)
        tabContent.Size = UDim2.new(1,-12,1,-12)
        tabContent.Position = UDim2.new(0,6,0,6)
        tabContent.BackgroundColor3 = Color3.fromRGB(20,20,20)
        tabContent.Visible = false
        Instance.new("UICorner", tabContent).CornerRadius = UDim.new(0,6)

        local listLayout = Instance.new("UIListLayout", tabContent)
        listLayout.SortOrder = Enum.SortOrder.LayoutOrder
        listLayout.Padding = UDim.new(0,8)
        listLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
        listLayout.VerticalAlignment = Enum.VerticalAlignment.Top

        tabButton.MouseButton1Click:Connect(function()
            for _, child in ipairs(rightPanel:GetChildren()) do
                if child:IsA("Frame") then child.Visible = false end
            end
            tabContent.Visible = true
        end)

        local Tab = {}

        function Tab:AddButton(opts)
            opts = opts or {}
            local btn = Instance.new("TextButton", tabContent)
            btn.Size = UDim2.new(0.9,0,0,35)
            btn.BackgroundColor3 = Color3.fromRGB(50,50,50)
            btn.Text = opts.Name or "Button"
            btn.Font = Enum.Font.GothamBold
            btn.TextColor3 = Color3.fromRGB(255,255,255)
            btn.TextSize = 14
            Instance.new("UICorner", btn).CornerRadius = UDim.new(0,6)

            btn.MouseButton1Click:Connect(function()
                if typeof(opts.Callback) == "function" then
                    opts.Callback()
                end
            end)

            return btn
        end

        function Tab:AddSlider(opts)
            local frame = Instance.new("Frame", tabContent)
            frame.Size = UDim2.new(0.9,0,0,50)
            frame.BackgroundColor3 = Color3.fromRGB(40,40,40)
            Instance.new("UICorner", frame).CornerRadius = UDim.new(0,6)

            local label = Instance.new("TextLabel", frame)
            label.Size = UDim2.new(1,0,0.5,0)
            label.BackgroundTransparency = 1
            label.Text = opts.Name or "Slider"
            label.TextColor3 = Color3.fromRGB(255,255,255)
            label.Font = Enum.Font.GothamBold
            label.TextSize = 14

            local slider = Instance.new("TextButton", frame)
            slider.Size = UDim2.new(1,-20,0.5,-5)
            slider.Position = UDim2.new(0,10,0.5,0)
            slider.BackgroundColor3 = Color3.fromRGB(60,60,60)
            slider.Text = tostring(opts.Default or opts.Min or 0)
            Instance.new("UICorner", slider).CornerRadius = UDim.new(0,6)

            slider.MouseButton1Click:Connect(function()
                local val = tonumber(slider.Text) or opts.Default or 0
                val = val + 1
                if val > (opts.Max or 100) then val = opts.Min or 0 end
                slider.Text = tostring(val)
                if opts.Callback then opts.Callback(val) end
            end)
        end

        function Tab:AddDropdown(opts)
            local dd = Instance.new("TextButton", tabContent)
            dd.Size = UDim2.new(0.9,0,0,35)
            dd.BackgroundColor3 = Color3.fromRGB(50,50,50)
            dd.Text = opts.Default or opts.Options[1]
            dd.Font = Enum.Font.GothamBold
            dd.TextColor3 = Color3.fromRGB(255,255,255)
            dd.TextSize = 14
            Instance.new("UICorner", dd).CornerRadius = UDim.new(0,6)

            dd.MouseButton1Click:Connect(function()
                local nextIndex = table.find(opts.Options, dd.Text) or 1
                nextIndex = nextIndex % #opts.Options + 1
                dd.Text = opts.Options[nextIndex]
                if opts.Callback then opts.Callback(dd.Text) end
            end)
        end

        function Tab:AddToggle(opts)
            local btn = Instance.new("TextButton", tabContent)
            btn.Size = UDim2.new(0.9,0,0,35)
            btn.BackgroundColor3 = Color3.fromRGB(50,50,50)
            btn.Text = (opts.Default and "[X] " or "[ ] ") .. (opts.Name or "Toggle")
            btn.Font = Enum.Font.GothamBold
            btn.TextColor3 = Color3.fromRGB(255,255,255)
            btn.TextSize = 14
            Instance.new("UICorner", btn).CornerRadius = UDim.new(0,6)

            local state = opts.Default or false
            btn.MouseButton1Click:Connect(function()
                state = not state
                btn.Text = (state and "[X] " or "[ ] ") .. (opts.Name or "Toggle")
                if opts.Callback then opts.Callback(state) end
            end)
        end

        function Tab:AddColorPicker(opts)
            local btn = Instance.new("TextButton", tabContent)
            btn.Size = UDim2.new(0.9,0,0,35)
            btn.BackgroundColor3 = opts.Default or Color3.fromRGB(255,0,0)
            btn.Text = opts.Name or "Color Picker"
            btn.Font = Enum.Font.GothamBold
            btn.TextColor3 = Color3.fromRGB(255,255,255)
            btn.TextSize = 14
            Instance.new("UICorner", btn).CornerRadius = UDim.new(0,6)

            btn.MouseButton1Click:Connect(function()
                local newColor = Color3.fromRGB(math.random(0,255),math.random(0,255),math.random(0,255))
                btn.BackgroundColor3 = newColor
                if opts.Callback then opts.Callback(newColor) end
            end)
        end

        function Tab:AddLabel(text)
            local lbl = Instance.new("TextLabel", tabContent)
            lbl.Size = UDim2.new(0.9,0,0,25)
            lbl.BackgroundTransparency = 1
            lbl.Text = text
            lbl.TextColor3 = Color3.fromRGB(255,255,255)
            lbl.Font = Enum.Font.GothamBold
            lbl.TextSize = 14
            return lbl
        end

        function Tab:AddParagraph(title, body)
            local frame = Instance.new("Frame", tabContent)
            frame.Size = UDim2.new(0.9,0,0,60)
            frame.BackgroundColor3 = Color3.fromRGB(40,40,40)
            Instance.new("UICorner", frame).CornerRadius = UDim.new(0,6)

            local lbl = Instance.new("TextLabel", frame)
            lbl.Size = UDim2.new(1,0,1,0)
            lbl.BackgroundTransparency = 1
            lbl.Text = title.."\n"..body
            lbl.TextColor3 = Color3.fromRGB(255,255,255)
            lbl.Font = Enum.Font.Gotham
            lbl.TextSize = 14
        end

        function Tab:AddAdaptiveInput(opts)
            local box = Instance.new("TextBox", tabContent)
            box.Size = UDim2.new(0.9,0,0,35)
            box.BackgroundColor3 = Color3.fromRGB(50,50,50)
            box.Text = ""
            box.PlaceholderText = opts.Placeholder or "Type..."
            box.Font = Enum.Font.Code
            box.TextColor3 = Color3.fromRGB(255,255,255)
            box.TextSize = 14
            Instance.new("UICorner", box).CornerRadius = UDim.new(0,6)

            box.FocusLost:Connect(function()
                if opts.Callback then opts.Callback(box.Text) end
            end)
        end

        function Tab:AddKeybind(opts)
            local btn = Instance.new("TextButton", tabContent)
            btn.Size = UDim2.new(0.9,0,0,35)
            btn.BackgroundColor3 = Color3.fromRGB(50,50,50)
            btn.Text = "Keybind: "..(opts.Default and opts.Default.Name or "None")
            btn.Font = Enum.Font.GothamBold
            btn.TextColor3 = Color3.fromRGB(255,255,255)
            btn.TextSize = 14
            Instance.new("UICorner", btn).CornerRadius = UDim.new(0,6)

            local key = opts.Default or Enum.KeyCode.Unknown
            UIS.InputBegan:Connect(function(input, gp)
                if input.KeyCode == key then
                    if opts.Callback then opts.Callback(key) end
                end
            end)
        end

        return Tab
    end

    return Window
end

return UILibrary
