-- source.lua
-- Full UI Library

local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")

local UILibrary = {}

function UILibrary:MakeWindow(titleText)
    local player = Players.LocalPlayer
    local gui = Instance.new("ScreenGui")
    gui.Name = "ExecutorUI"
    gui.ResetOnSpawn = false
    gui.Parent = player:WaitForChild("PlayerGui")

    -- Main window
    local main = Instance.new("Frame")
    main.Size = UDim2.new(0,600,0,400)
    main.Position = UDim2.new(0.5,-300,0.5,-200)
    main.BackgroundColor3 = Color3.fromRGB(20,20,20)
    main.BorderSizePixel = 0
    main.ClipsDescendants = true
    main.Parent = gui
    Instance.new("UICorner", main).CornerRadius = UDim.new(0,10)

    -- Dragging
    local dragging, dragStart, startPos = false, nil, nil
    local function beginDrag(input)
        dragging = true
        dragStart = input.Position
        startPos = main.Position
    end
    local function endDrag() dragging = false end
    UIS.InputChanged:Connect(function(input)
        if dragging and input.UserInputType==Enum.UserInputType.MouseMovement then
            local delta = input.Position - dragStart
            main.Position = UDim2.new(
                startPos.X.Scale,
                startPos.X.Offset + delta.X,
                startPos.Y.Scale,
                startPos.Y.Offset + delta.Y
            )
        end
    end)

    -- Top bar
    local bar = Instance.new("Frame", main)
    bar.Size = UDim2.new(1,0,0,40)
    bar.BackgroundColor3 = Color3.fromRGB(30,30,30)
    bar.BorderSizePixel = 0
    Instance.new("UICorner", bar).CornerRadius = UDim.new(0,10)

    bar.InputBegan:Connect(function(input)
        if input.UserInputType==Enum.UserInputType.MouseButton1 then beginDrag(input) end
    end)
    bar.InputEnded:Connect(function(input)
        if input.UserInputType==Enum.UserInputType.MouseButton1 then endDrag() end
    end)

    local title = Instance.new("TextLabel", bar)
    title.Size = UDim2.new(1,-90,1,0)
    title.Position = UDim2.new(0,12,0,0)
    title.BackgroundTransparency = 1
    title.Font = Enum.Font.GothamBold
    title.Text = titleText or "Executor UI"
    title.TextColor3 = Color3.fromRGB(210,210,210)
    title.TextSize = 17
    title.TextXAlignment = Enum.TextXAlignment.Left

    -- Close + Minimize
    local close = Instance.new("TextButton", bar)
    close.Size = UDim2.new(0,35,0,26)
    close.Position = UDim2.new(1,-40,0.5,-13)
    close.BackgroundColor3 = Color3.fromRGB(50,20,20)
    close.Text = "X"
    close.Font = Enum.Font.GothamBold
    close.TextColor3 = Color3.fromRGB(255,90,90)
    close.TextSize = 16
    Instance.new("UICorner", close).CornerRadius = UDim.new(0,6)

    local min = Instance.new("TextButton", bar)
    min.Size = UDim2.new(0,35,0,26)
    min.Position = UDim2.new(1,-80,0.5,-13)
    min.BackgroundColor3 = Color3.fromRGB(40,40,40)
    min.Text = "â€“"
    min.Font = Enum.Font.GothamBold
    min.TextColor3 = Color3.fromRGB(200,200,200)
    min.TextSize = 24
    Instance.new("UICorner", min).CornerRadius = UDim.new(0,6)

    -- Bottom panel
    local bottom = Instance.new("Frame", main)
    bottom.Size = UDim2.new(1,-20,1,-60)
    bottom.Position = UDim2.new(0,10,0,50)
    bottom.BackgroundColor3 = Color3.fromRGB(25,25,25)
    bottom.BorderSizePixel = 0
    bottom.ClipsDescendants = true
    Instance.new("UICorner", bottom).CornerRadius = UDim.new(0,8)

    -- Left tab list
    local leftTab = Instance.new("Frame", bottom)
    leftTab.Size = UDim2.new(0,130,1,0)
    leftTab.BackgroundColor3 = Color3.fromRGB(30,30,30)
    leftTab.BorderSizePixel = 0
    leftTab.ClipsDescendants = true
    Instance.new("UICorner", leftTab).CornerRadius = UDim.new(0,8)

    local tabList = Instance.new("UIListLayout", leftTab)
    tabList.SortOrder = Enum.SortOrder.LayoutOrder
    tabList.Padding = UDim.new(0,5)

    -- Right content panel
    local rightPanel = Instance.new("Frame", bottom)
    rightPanel.Size = UDim2.new(1,-140,1,0)
    rightPanel.Position = UDim2.new(0,140,0,0)
    rightPanel.BackgroundColor3 = Color3.fromRGB(15,15,15)
    rightPanel.BorderSizePixel = 0
    Instance.new("UICorner", rightPanel).CornerRadius = UDim.new(0,8)

    -- Animations
    local minimized = false
    local fullSize = UDim2.new(0,600,0,400)
    local minSize = UDim2.new(0,600,0,40)

    min.MouseButton1Click:Connect(function()
        minimized = not minimized
        local target = minimized and minSize or fullSize
        TweenService:Create(main,TweenInfo.new(.25,Enum.EasingStyle.Sine),{Size=target}):Play()
        if minimized then
            TweenService:Create(bottom,TweenInfo.new(.2),{Size=UDim2.new(1,-20,0,0)}):Play()
        else
            TweenService:Create(bottom,TweenInfo.new(.2),{Size=UDim2.new(1,-20,1,-60)}):Play()
        end
    end)

    close.MouseButton1Click:Connect(function()
        TweenService:Create(main,TweenInfo.new(.25),{Size=minSize}):Play()
        TweenService:Create(bottom,TweenInfo.new(.25),{Size=UDim2.new(1,-20,0,0)}):Play()
        task.wait(.4)
        TweenService:Create(main,TweenInfo.new(.35),{Size=UDim2.new(0,0,0,40)}):Play()
        task.wait(.35)
        gui:Destroy()
    end)

    -- API
    local Window = {}

    function Window:MakeTab(name)
        local tabButton = Instance.new("TextButton", leftTab)
        tabButton.Size = UDim2.new(1,-10,0,30)
        tabButton.BackgroundColor3 = Color3.fromRGB(40,40,40)
        tabButton.Text = name
        tabButton.Font = Enum.Font.GothamBold
        tabButton.TextColor3 = Color3.fromRGB(220,220,220)
        tabButton.TextSize = 14
        Instance.new("UICorner", tabButton).CornerRadius = UDim.new(0,6)

        local tabContent = Instance.new("Frame", rightPanel)
        tabContent.Size = UDim2.new(1,-12,1,-12)
        tabContent.Position = UDim2.new(0,6,0,6)
        tabContent.BackgroundColor3 = Color3.fromRGB(20,20,20)
        tabContent.Visible = false
        Instance.new("UICorner", tabContent).CornerRadius = UDim.new(0,6)

        tabButton.MouseButton1Click:Connect(function()
            for _, child in ipairs(rightPanel:GetChildren()) do
                if child:IsA("Frame") then child.Visible = false end
            end
            tabContent.Visible = true
        end)

        local Tab = {}
        function Tab:AddButton(opts)
            opts = opts or {}
            local btn = Instance.new("TextButton", tabContent)
            btn.Size = UDim2.new(0,150,0,30)
            btn.Position = UDim2.new(0,10,0,10)
            btn.BackgroundColor3 = Color3.fromRGB(50,50,50)
            btn.Text = opts.Name or "Button"
            btn.Font = Enum.Font.GothamBold
            btn.TextColor3 = Color3.fromRGB(255,255,255)
            btn.TextSize = 14
            Instance.new("UICorner", btn).CornerRadius = UDim.new(0,6)

            btn.MouseButton1Click:Connect(function()
                if typeof(opts.Callback) == "function" then
                    opts.Callback()
                end
            end)

            return btn
        end

        return Tab
    end

    return Window
end

return UILibrary
